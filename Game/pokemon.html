<!-- https://pokemondb.net/pokedex/all -->

<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gioco Pok√©mon - Confronto Statistiche</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #f5f5f5;
    }
    h1 {
      color: #ffcc00;
    }
    .container {
      display: flex;
      justify-content: center;
      gap: 50px;
      margin-top: 30px;
    }
    .pokemon {
      text-align: center;
    }
    .pokemon img {
      width: 100px;
      height: 100px;
      image-rendering: pixelated;
    }
    .options {
      margin-top: 20px;
    }
    .options button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    #score, #highscore {
      font-size: 20px;
      margin-top: 15px;
    }

    /* Popup Game Over */
    #gameOverPopup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      justify-content: center;
      align-items: center;
    }
    #gameOverPopup .popup-content {
      background: white;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      max-width: 300px;
    }
    #gameOverPopup button {
      margin-top: 15px;
      padding: 10px 20px;
      cursor: pointer;
      font-size: 16px;
    }

    #timer {
      font-size: 22px;
      color: #d32f2f;
      margin-top: 15px;
    }
  </style>
</head>
<body>

  <h1 id="title">Gioco Pok√©mon - Confronto Statistiche</h1>
  <div id="score">Punteggio: 0</div>
  <div id="highscore"></div>
  <div id="timer">Tempo: 10s</div>

  <div class="container">
    <div id="player" class="pokemon">
      <img id="player-sprite" src="" alt="Pok√©mon">
      <div id="player-name"></div>
    </div>

    <div id="opponent" class="pokemon">
      <img id="opponent-sprite" src="" alt="Pok√©mon">
      <div id="opponent-name"></div>
    </div>
  </div>

  <div id="comparison" class="stats" style="margin-top: 20px; font-size: 18px;"></div>

  <div class="options">
    <button id="greater">S√¨</button>
    <button id="not-greater">No</button>
  </div>

  <!-- POPUP GAME OVER -->
  <div id="gameOverPopup">
    <div class="popup-content">
      <h2 id="gameOverTitle">Game Over!</h2>
      <p id="finalScore"></p>
      <p id="highScoreMessage"></p>
      <button id="closePopup">Chiudi</button>
    </div>
  </div>

  <script>
    let pokemonList = [];
    let score = 0;
    let gameOver = false;
    let timer;
    let timeLeft = 10;
    let lang = navigator.language.slice(0, 2); // rileva "it", "en", "fr", ecc.

    // Dizionario traduzioni
const translations = {
  it: {
    title: "Gioco Pok√©mon - Confronto Statistiche",
    score: "Punteggio",
    record: "Record",
    time: "Tempo",
    yes: "S√¨",
    no: "No",
    gameOver: "Game Over!",
    newRecord: "üéâ Nuovo record!",
    currentRecord: "Record attuale",
    close: "Chiudi",
    timeout: "Tempo scaduto!",
    wrong: "Hai sbagliato!",
    question: (p1, stat, p2) => `Il tuo ${p1} ha pi√π ${stat} di ${p2}?`
  },
  en: {
    title: "Pok√©mon Game - Stat Comparison",
    score: "Score",
    record: "High Score",
    time: "Time",
    yes: "Yes",
    no: "No",
    gameOver: "Game Over!",
    newRecord: "üéâ New Record!",
    currentRecord: "Current record",
    close: "Close",
    timeout: "Time‚Äôs up!",
    wrong: "Wrong!",
    question: (p1, stat, p2) => `Does your ${p1} have more ${stat} than ${p2}?`
  },
  fr: {
    title: "Jeu Pok√©mon - Comparaison de Statistiques",
    score: "Score",
    record: "Record",
    time: "Temps",
    yes: "Oui",
    no: "Non",
    gameOver: "Fin du jeu !",
    newRecord: "üéâ Nouveau record !",
    currentRecord: "Record actuel",
    close: "Fermer",
    timeout: "Temps √©coul√© !",
    wrong: "Faux !",
    question: (p1, stat, p2) => `Ton ${p1} a-t-il plus de ${stat} que ${p2} ?`
  },
  es: {
    title: "Juego Pok√©mon - Comparaci√≥n de Estad√≠sticas",
    score: "Puntuaci√≥n",
    record: "R√©cord",
    time: "Tiempo",
    yes: "S√≠",
    no: "No",
    gameOver: "¬°Fin del juego!",
    newRecord: "üéâ ¬°Nuevo r√©cord!",
    currentRecord: "R√©cord actual",
    close: "Cerrar",
    timeout: "¬°Tiempo agotado!",
    wrong: "¬°Incorrecto!",
    question: (p1, stat, p2) => `¬øTu ${p1} tiene m√°s ${stat} que ${p2}?`
  },
  de: {
    title: "Pok√©mon-Spiel ‚Äì Statistikvergleich",
    score: "Punkte",
    record: "Rekord",
    time: "Zeit",
    yes: "Ja",
    no: "Nein",
    gameOver: "Spiel vorbei!",
    newRecord: "üéâ Neuer Rekord!",
    currentRecord: "Aktueller Rekord",
    close: "Schlie√üen",
    timeout: "Zeit abgelaufen!",
    wrong: "Falsch!",
    question: (p1, stat, p2) => `Hat dein ${p1} mehr ${stat} als ${p2}?`
  },
  pt: {
    title: "Jogo Pok√©mon - Compara√ß√£o de Estat√≠sticas",
    score: "Pontua√ß√£o",
    record: "Recorde",
    time: "Tempo",
    yes: "Sim",
    no: "N√£o",
    gameOver: "Fim de jogo!",
    newRecord: "üéâ Novo recorde!",
    currentRecord: "Recorde atual",
    close: "Fechar",
    timeout: "Tempo esgotado!",
    wrong: "Errado!",
    question: (p1, stat, p2) => `Seu ${p1} tem mais ${stat} que ${p2}?`
  },
  ru: {
    title: "–ò–≥—Ä–∞ –ü–æ–∫–µ–º–æ–Ω ‚Äî –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫",
    score: "–°—á—ë—Ç",
    record: "–†–µ–∫–æ—Ä–¥",
    time: "–í—Ä–µ–º—è",
    yes: "–î–∞",
    no: "–ù–µ—Ç",
    gameOver: "–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!",
    newRecord: "üéâ –ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!",
    currentRecord: "–¢–µ–∫—É—â–∏–π —Ä–µ–∫–æ—Ä–¥",
    close: "–ó–∞–∫—Ä—ã—Ç—å",
    timeout: "–í—Ä–µ–º—è –≤—ã—à–ª–æ!",
    wrong: "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!",
    question: (p1, stat, p2) => `–£ —Ç–≤–æ–µ–≥–æ ${p1} –±–æ–ª—å—à–µ ${stat}, —á–µ–º —É ${p2}?`
  },
  zh: {
    title: "ÂÆùÂèØÊ¢¶Ê∏∏Êàè - Â±ûÊÄßÂØπÊØî",
    score: "ÂæóÂàÜ",
    record: "ÊúÄÈ´òÂàÜ",
    time: "Êó∂Èó¥",
    yes: "ÊòØ",
    no: "Âê¶",
    gameOver: "Ê∏∏ÊàèÁªìÊùüÔºÅ",
    newRecord: "üéâ Êñ∞Á∫™ÂΩïÔºÅ",
    currentRecord: "ÂΩìÂâçÁ∫™ÂΩï",
    close: "ÂÖ≥Èó≠",
    timeout: "Êó∂Èó¥Âà∞ÔºÅ",
    wrong: "ÈîôËØØÔºÅ",
    question: (p1, stat, p2) => `‰Ω†ÁöÑ${p1}ÊØî${p2}ÁöÑ${stat}Êõ¥È´òÂêóÔºü`
  },
  ja: {
    title: "„Éù„Ç±„É¢„É≥„Ç≤„Éº„É† - „Çπ„ÉÜ„Éº„Çø„ÇπÊØîËºÉ",
    score: "„Çπ„Ç≥„Ç¢",
    record: "„Éè„Ç§„Çπ„Ç≥„Ç¢",
    time: "ÊôÇÈñì",
    yes: "„ÅØ„ÅÑ",
    no: "„ÅÑ„ÅÑ„Åà",
    gameOver: "„Ç≤„Éº„É†„Ç™„Éº„Éê„ÉºÔºÅ",
    newRecord: "üéâ Êñ∞Ë®òÈå≤ÔºÅ",
    currentRecord: "ÁèæÂú®„ÅÆË®òÈå≤",
    close: "Èñâ„Åò„Çã",
    timeout: "ÊôÇÈñìÂàá„ÇåÔºÅ",
    wrong: "ÈñìÈÅï„ÅÑÔºÅ",
    question: (p1, stat, p2) => `„ÅÇ„Å™„Åü„ÅÆ${p1}„ÅØ${p2}„Çà„Çä${stat}„ÅåÈ´ò„ÅÑ„Åß„Åô„ÅãÔºü`
  },
  ko: {
    title: "Ìè¨ÏºìÎ™¨ Í≤åÏûÑ - Îä•Î†•Ïπò ÎπÑÍµê",
    score: "Ï†êÏàò",
    record: "Í∏∞Î°ù",
    time: "ÏãúÍ∞Ñ",
    yes: "Ïòà",
    no: "ÏïÑÎãàÏò§",
    gameOver: "Í≤åÏûÑ Ïò§Î≤Ñ!",
    newRecord: "üéâ ÏÉàÎ°úÏö¥ Í∏∞Î°ù!",
    currentRecord: "ÌòÑÏû¨ Í∏∞Î°ù",
    close: "Îã´Í∏∞",
    timeout: "ÏãúÍ∞Ñ Ï¢ÖÎ£å!",
    wrong: "ÌãÄÎ†∏ÏäµÎãàÎã§!",
    question: (p1, stat, p2) => `ÎãπÏã†Ïùò ${p1}Í∞Ä ${p2}Î≥¥Îã§ ${stat}Í∞Ä ÎÜíÏäµÎãàÍπå?`
  }
};

    // Usa inglese come fallback
    const t = translations[lang] || translations.en;

    // Imposta testo in base alla lingua
    document.getElementById("title").innerText = t.title;
    document.getElementById("greater").innerText = t.yes;
    document.getElementById("not-greater").innerText = t.no;
    document.getElementById("gameOverTitle").innerText = t.gameOver;
    document.getElementById("closePopup").innerText = t.close;

    // Carica high score da localStorage
    let highScore = localStorage.getItem("highScore") ? parseInt(localStorage.getItem("highScore")) : 0;
    document.getElementById("highscore").innerText = `${t.record}: ${highScore}`;

    // Stat names (multilingua)
    const statNames = {
  it: {
    hp: "HP",
    attack: "Attacco",
    defense: "Difesa",
    spattack: "Attacco Speciale",
    spdefense: "Difesa Speciale",
    speed: "Velocit√†"
  },
  en: {
    hp: "HP",
    attack: "Attack",
    defense: "Defense",
    spattack: "Sp. Attack",
    spdefense: "Sp. Defense",
    speed: "Speed"
  },
  fr: {
    hp: "HP",
    attack: "Attaque",
    defense: "D√©fense",
    spattack: "Attaque Sp√©ciale",
    spdefense: "D√©fense Sp√©ciale",
    speed: "Vitesse"
  },
  es: {
    hp: "HP",
    attack: "Ataque",
    defense: "Defensa",
    spattack: "At. Especial",
    spdefense: "Def. Especial",
    speed: "Velocidad"
  },
  de: {
    hp: "HP",
    attack: "Angriff",
    defense: "Verteidigung",
    spattack: "Spezial-Angriff",
    spdefense: "Spezial-Verteidigung",
    speed: "Initiative"
  },
  pt: {
    hp: "HP",
    attack: "Ataque",
    defense: "Defesa",
    spattack: "Ataque Especial",
    spdefense: "Defesa Especial",
    speed: "Velocidade"
  },
  ru: {
    hp: "HP",
    attack: "–ê—Ç–∞–∫–∞",
    defense: "–ó–∞—â–∏—Ç–∞",
    spattack: "–°–ø–µ—Ü. –ê—Ç–∞–∫–∞",
    spdefense: "–°–ø–µ—Ü. –ó–∞—â–∏—Ç–∞",
    speed: "–°–∫–æ—Ä–æ—Å—Ç—å"
  },
  zh: {
    hp: "HP",
    attack: "ÊîªÂáª",
    defense: "Èò≤Âæ°",
    spattack: "ÁâπÊîª",
    spdefense: "ÁâπÈò≤",
    speed: "ÈÄüÂ∫¶"
  },
  ja: {
    hp: "HP",
    attack: "„Åì„ÅÜ„Åí„Åç",
    defense: "„Åº„ÅÜ„Åé„Çá",
    spattack: "„Å®„Åè„Åì„ÅÜ",
    spdefense: "„Å®„Åè„Åº„ÅÜ",
    speed: "„Åô„Å∞„ÇÑ„Åï"
  },
  ko: {
    hp: "HP",
    attack: "Í≥µÍ≤©",
    defense: "Î∞©Ïñ¥",
    spattack: "ÌäπÏàòÍ≥µÍ≤©",
    spdefense: "ÌäπÏàòÎ∞©Ïñ¥",
    speed: "Ïä§ÌîºÎìú"
  }
  };

    async function loadPokemonList() {
      try {
        const response = await fetch('pokemonList.json');
        if (!response.ok) throw new Error('Errore nel caricare il file JSON');
        pokemonList = await response.json();
        startRound();
      } catch (error) {
        console.error('Errore:', error);
        alert('Non √® stato possibile caricare la lista dei Pok√©mon.');
      }
    }

    function getRandomPokemon() {
      return pokemonList[Math.floor(Math.random() * pokemonList.length)];
    }

    // Utility: normalizza solo per l'URL dell'immagine
function getSpriteUrl(name) {
  const normalized = name
    .toLowerCase()
    .replace(/[^a-z0-9\s-]/g, "") // rimuove punteggiatura
    .replace(/\s+/g, "-");        // spazi -> trattino
  return `https://play.pokemonshowdown.com/sprites/gen5/${normalized}.png`;
}

function updatePokemonDisplay(player, opponent) {
  document.getElementById("player-sprite").src = getSpriteUrl(player.name);
  document.getElementById("opponent-sprite").src = getSpriteUrl(opponent.name);

  // Mantiene il nome originale leggibile
  document.getElementById("player-name").innerText = player.name;
  document.getElementById("opponent-name").innerText = opponent.name;
}

  document.getElementById("player-sprite").src = playerImg;
  document.getElementById("opponent-sprite").src = opponentImg;
  document.getElementById("player-name").innerText = player.name;
  document.getElementById("opponent-name").innerText = opponent.name;
}


    function getComparison(player, opponent) {
      const stats = ["hp", "attack", "defense", "spattack", "spdefense", "speed"];
      const stat = stats[Math.floor(Math.random() * stats.length)];
      return {
        stat,
        playerStat: player.stats[stat],
        opponentStat: opponent.stats[stat],
        isGreater: player.stats[stat] > opponent.stats[stat]
      };
    }

    function startTimer() {
      clearInterval(timer);
      timeLeft = 10;
      document.getElementById("timer").innerText = `${t.time}: ${timeLeft}s`;

      timer = setInterval(() => {
        if (gameOver) {
          clearInterval(timer);
          return;
        }
        timeLeft--;
        document.getElementById("timer").innerText = `${t.time}: ${timeLeft}s`;
        if (timeLeft <= 0) {
          clearInterval(timer);
          triggerGameOver(t.timeout);
        }
      }, 1000);
    }

    function handleAnswer(isGreater, comparison) {
      if (gameOver) return;
      const isCorrect = (isGreater && comparison.isGreater) || (!isGreater && !comparison.isGreater);

      if (isCorrect) {
        score++;
        document.getElementById("score").innerText = `${t.score}: ${score}`;
        startRound();
      } else {
        triggerGameOver(t.wrong);
      }
    }

    function triggerGameOver(reason) {
      clearInterval(timer);
      gameOver = true;

      let newRecord = false;
      if (score > highScore) {
        highScore = score;
        localStorage.setItem("highScore", highScore);
        newRecord = true;
      }

      document.getElementById("finalScore").innerText = `${t.score}: ${score}`;
      document.getElementById("highScoreMessage").innerText = newRecord ? t.newRecord : `${t.currentRecord}: ${highScore}`;
      document.getElementById("gameOverPopup").style.display = "flex";
    }

    function startRound() {
      if (pokemonList.length === 0) return;

      const player = getRandomPokemon();
      const opponent = getRandomPokemon();
      const comparison = getComparison(player, opponent);

      updatePokemonDisplay(player, opponent);
      const statLabel = statNames[lang]?.[comparison.stat] || statNames.it[comparison.stat];
      document.getElementById("comparison").innerText = t.question(player.name, statLabel, opponent.name);

      document.getElementById("greater").onclick = () => handleAnswer(true, comparison);
      document.getElementById("not-greater").onclick = () => handleAnswer(false, comparison);

      startTimer();
    }

    document.getElementById("closePopup").onclick = () => {
      document.getElementById("gameOverPopup").style.display = "none";
      location.reload();
    };

    loadPokemonList();
  </script>

</body>
</html>
